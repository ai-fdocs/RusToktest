# alloy-scripting

## Назначение
`alloy-scripting` — движок скриптов на основе Rhai для автоматизации бизнес-логики, хуков и запланированных задач.

## Что делает
- Выполняет скрипты на языке Rhai в изолированном окружении.
- Предоставляет API для интеграции скриптов с сущностями платформы.
- Поддерживает хуки (before/after) для операций с данными.
- Реализует планировщик для периодических задач (cron).
- Управляет жизненным циклом скриптов (регистрация, запуск, остановка).

## Как работает (простыми словами)
1. Разработчик создаёт скрипт на Rhai и регистрирует его в системе.
2. Скрипт может быть привязан к событиям (хуки) или расписанию.
3. При срабатывании триггера движок создаёт изолированный контекст выполнения.
4. Скрипт выполняется с доступом к API платформы через прокси-объекты.
5. Результат выполнения логируется и может повлиять на дальнейшую обработку.

## Ключевые компоненты
- `engine/` — ядро движка Rhai с конфигурацией и sandbox.
- `bridge/` — мост между Rust и Rhai (регистрация функций, прокси).
- `runner/` — оркестратор выполнения скриптов и хуков.
- `scheduler/` — планировщик периодических задач с поддержкой cron.
- `storage/` — хранилище скриптов (in-memory и SeaORM).
- `api/` — HTTP API для управления скриптами.

## Кому нужен
Для расширения функциональности платформы без изменения исходного кода:
- Автоматизация бизнес-процессов.
- Кастомная валидация данных.
- Интеграция с внешними системами.
- Периодические отчёты и задачи.

This is an alpha version and requires clarification. Be careful, there may be errors in the text. So that no one thinks that this is an immutable rule.

## Взаимодействие
- crates/rustok-core
- apps/server (для HTTP API)

## Документация
- Локальная документация: `./docs/`
- Общая документация платформы: `/docs`

## Паспорт компонента
- **Роль в системе:** Движок скриптов для расширения функциональности платформы.
- **Основные данные/ответственность:** выполнение скриптов Rhai, хуки, планировщик задач.
- **Взаимодействует с:**
  - crates/rustok-core
  - apps/server
- **Точки входа:**
  - `crates/alloy-scripting/src/lib.rs`
- **Локальная документация:** `./docs/`
- **Глобальная документация платформы:** `/docs/`
